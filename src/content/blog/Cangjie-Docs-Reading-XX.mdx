---
title: "仓颉文档阅读-语言规约XI: 包和模块管理"
pubDate: "2025-10-14 18:26:44"
description: "一直对仓颉挺感兴趣的, 但是一直没有去读一下文档, 慢慢看一看, 了解一下"
image: 'https://humid1ch.oss-cn-shanghai.aliyuncs.com/20250929154944807.webp'
categories: 
    - Blogs
tags:
    - 开发语言
    - 仓颉
---

import Info from "../../components/mdx/Info.astro";

import Warning from "../../components/mdx/Warning.astro";

import Question from "../../components/mdx/Question.astro";

<Info>

阅读文档版本:

语言规约 [Cangjie-0.53.18-Spec](https://cangjie-lang.cn/docs?url=/0.53.18/Spec/source_zh_cn/Chapter_01_Lexical_Structure(zh).html)

具体开发指南 [Cangjie-LTS-1.0.1](https://cangjie-lang.cn/docs?url=/1.0.1/index.html)

在阅读 了解仓颉的语言规约时, 难免会涉及到一些仓颉的示例代码, 但 我们对仓颉并不熟悉, 所以可以用[仓颉在线体验](https://cangjie-lang.cn/playground)快速验证

有条件当然可以直接[配置Canjie-SDK](https://cangjie-lang.cn/download/1.0.1)

</Info>

<Warning>

博主在此之前, 基本就只接触过C/C++语言, 对大多现代语言都没有了解, 所以在阅读过程中遇到相似的概念, 难免会与C/C++中的相似概念作类比, 见谅

</Warning>

> 此样式内容, 表示文档原文内容

---

终于到包和模块管理了

## 包和模块管理

> 在仓颉编程语言中，程序以包的形式进行组织，**包是最小的编译单元**
> 
> 包可以定义子包，从而构成树形结构
> 
> 没有父包的包称为 `root` 包，`root` 包及其子包（包括子包的子包）构成的整棵树称为 `module`
> 
> `module` 的名称与 `root` 包相同
> 
> `module` 是仓颉的最小发布单元
> 
> 包由一个或多个源码文件组成，**同一个包的源码文件必须在同一个目录**，并且**同一个目录里的源码文件只能属于同一个包**
> 
> 子包的目录是其父包目录的子目录

仓颉中, 包可以拥有子包, 没有父包就是`root`包, `root`包及其子包构成整个`module`

`module` 是仓颉的最小发布单元, 包是最小编译单元

### 包

#### 包的声明


> 包声明以关键字 `package` 开头，后接 `root` 包至当前包路径上所有包的包名，以 `.` 分隔（路径本身不是包名）
> 
> 包声明的语法如下：
> 
> ```cangjie
> packageHeader
>     : packageModifier? (MACRO NL*)? PACKAGE NL* fullPackageName end+
>     ;
> 
> fullPackageName
>     : (packageNameIdentifier NL* DOT NL*)* packageNameIdentifier
>     ;
> 
> packageNameIdentifier
>     : Ident
>     | contextIdent
>     ;
> 
> packageModifier
>     : PUBLIC
>     | PROTECTED
>     | INTERNAL
>     ;
> ```
> 
> 每个包都有包名，包名是这个包可唯一识别的标识符
> 
> 除 `root` 包外，包名必须和其所在的目录名一致
> 
> **包声明必须在文件的首行**（注释和空白字符不计），每个文件**只能有一个 `package` 声明**
> 
> 特别地，`root` 包的文件可以不声明 `package`，对于不包含 `package` 声明的文件，它会用 `default` 作为包名
> 
> ```cangjie
> // ./src/main.cj
> // 省略包声明相当于'package default'
> 
> main() {
>     println("Hello World")
> }
> ```
> 
> `package` 可以被 `internal`、`protected` 或者 `public` 修饰
> 
> `package` 的默认修饰符（默认修饰符是指在省略情况下的修饰符语义，这些默认修饰符也允许显式写出）为 `public`
> 
> 同一个包在不同文件中的 `package` 声明必须使用相同的访问修饰符修饰
> 
> 特别地，`root` 包不能被 `internal` 或者 `protected` 修饰
> 
> - **`internal` 表示仅当前包及子包（包括子包的子包）内可见**
> 
>     当前包的子包（包括子包的子包）内可以导入这个包或者这个包的成员
> 
> - **`protected` 表示仅当前 `module` 内可见**
> 
>     同一个 `module` 内的其它包可以导入这个包或者这个包的成员，不同 `module` 的包无法访问
> 
> - **`public` 表示 `module` 内外均可见**
> 
>    其它包可以导入这个包或者这个包的成员

仓颉中, 声明包的语法是`包修饰词 package 包名`

在`.cj`文件中声明包, 就表示此文件属于所声明的包, 当然 前提是目录结构合法

如果不显式声明包, 则 `package default`

### 包的成员

> 包的成员是在顶层声明的类、接口、`struct`、`enum`、类型别名、全局变量、扩展、函数
> 
> 当前包的父包和子包 并不是当前包的成员，**访问父包或者子包需要 包的导入机制**，未被导入的包名不在 `top-level` 作用域中
> 
> 如下所示的例子中，`package a.b` 是 `package a` 的子包
> 
> ```cangjie
> // src/a.cj
> package a
> let a = 0                 // ok
> 
> // src/b/b.cj
> package a.b
> let a = 0                 // ok
> let b = 0                 // ok
> ```
> 
> 如下所示的例子中，`package a.b` 是 `package a` 的子包
> 
> ```cangjie
> // src/a.cj
> package a
> 
> let u = 0                 // ok
> let _ = b.x               // Error: 未声明的标识符 'b'
> let _ = a.u               // Error: 未声明的标识符 'a'
> let _ = a.b.x             // Error: 未声明的标识符 'a'
> 
> // src/b/b.cj
> package a.b
> 
> let x = 1                 // ok
> let _ = a.u               // Error: 未声明的标识符 'a'
> let _ = a.b.x             // Error: 未声明的标识符 'a'
> let _ = b.x               // Error: 未声明的标识符 'b'
> ```
> 
> 特别地，**子包不能和当前包的成员同名**，这是为了保证访问路径中的名称是唯一的

不能尝试通过当前包的包名访问当前包的成员

### 访问修饰符


> 仓颉中，可以使用访问修饰符来保护对类型、变量、函数等元素的访问
> 
> 仓颉有 4 种不同的访问修饰符
> 
> - `private`
> 
> - `internal`
> 
> - `protected`
> 
> - `public`

这四种访问修饰符, 并不只是修饰包用的

#### 修饰顶层元素


> 在修饰顶层元素时不同访问修饰符的语义如下：
> 
> - `private` 表示仅当前文件内可见
> 
>     不同的文件无法访问这类成员
> 
> - `internal` 表示仅当前包及子包（包括子包的子包）内可见
> 
>     同一个包内可以不导入就访问这类成员，当前包的子包（包括子包的子包）内可以通过导入来访问这类成员
> 
> - `protected` 表示仅当前 `module` 内可见
> 
>     同一个包的文件可以不导入就访问这类成员，不同包但是在同一个 `module` 内的其它包可以通过导入访问这些成员，不同 `module` 的包无法访问
> 
> - `public` 表示 `module` 内外均可见
> 
>     同一个包的文件可以不导入就访问这类成员，其它包可以通过导入访问这些成员
> 
> | File | Package & Sub-Packages | Module | All | Packages |
> | ---- | ---------------------- | ------ | --- | -------- |
> | `private` | Y | N | N | N |
> | `internal` | Y | Y | N | N |
> | `protected` | Y | Y | Y | N |
> | `public` | Y | Y | Y | Y |
> 
> 不同顶层声明支持的访问修饰符和默认修饰符规定如下：
> 
> - `pacakge` 支持使用 `internal`、`protected`、`public`，默认修饰符为 `public`
> 
> - `import` 支持使用全部访问修饰符，默认修饰符为 `private`
> 
> - 其他顶层声明支持使用全部访问修饰符，默认修饰符为 `internal`
